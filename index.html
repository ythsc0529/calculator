<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>麻將工具箱</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    </head>
<body>

    <header>
        <h1>麻將工具箱</h1>
        <nav>
            <button id="nav-calculator" class="nav-btn active">聽牌/打聽計算機</button>
            <button id="nav-challenge" class="nav-btn">清一色試煉</button>
            <button id="nav-counter" class="nav-btn">麻將計數器</button>
            <button id="nav-dice" class="nav-btn">麻將骰子</button>
            <button id="nav-fortune" class="nav-btn">招財神</button>
            <button id="nav-finder" class="nav-btn">找牌咖</button>
        </nav>
        <div id="settings-btn" class="settings-icon">⚙️</div>
    </header>

    <main>
        <div id="calculator-section" class="content-section active">
            <h2>聽牌/打聽計算機</h2>
            <div id="calculator-input-area"><p>請點擊下方的麻將牌來輸入您的手牌（最多17張）</p><div id="user-hand" class="hand-display"></div><div class="calculator-controls"><button id="calculate-btn">計算</button><button id="clear-hand-btn">清除</button></div></div>
            <div id="calculator-result-area" class="result-area"></div><div id="tile-selection" class="tile-selection-grid"></div>
        </div>

        <div id="challenge-section" class="content-section">
            <h2>清一色試煉</h2>
            <div class="challenge-options"><span>模式選擇：</span><button id="challenge-ting-btn" class="challenge-mode-btn" data-mode="ting">練習聽牌</button><button id="challenge-da-ting-btn" class="challenge-mode-btn" data-mode="da-ting">練習打聽</button></div>
            <div id="challenge-board"><p id="challenge-question"></p><div id="challenge-hand" class="hand-display"></div><div id="challenge-answer-area"></div><div id="challenge-feedback" class="result-area"></div><button id="next-challenge-btn" style="display: none;">下一題</button></div>
        </div>

        <div id="counter-section" class="content-section">
            <h2>麻將計數器</h2>
            <div id="counter-setup"><div class="player-setup"><input type="text" id="player1-name" placeholder="東方玩家名"><input type="text" id="player2-name" placeholder="南方玩家名"><input type="text" id="player3-name" placeholder="西方玩家名"><input type="text" id="player4-name" placeholder="北方玩家名"></div><div class="stake-setup"><span>籌碼選擇：</span><select id="stake-select"><option value="1/1">1 / 1</option><option value="3/1">3 / 1</option><option value="5/2">5 / 2</option><option value="10/2">10 / 2</option><option value="10/5">10 / 5</option></select></div><button id="start-game-btn">開始計分</button></div>
            <div id="counter-main" style="display: none;"><div class="mahjong-table"><div id="player-display-1" class="player-box top"></div><div id="player-display-2" class="player-box right"></div><div id="player-display-3" class="player-box bottom"></div><div id="player-display-4" class="player-box left"></div><div class="table-center"><button id="zimo-btn">自摸</button><button id="hu-btn">胡牌</button><button id="settle-btn">結算</button></div></div></div>
        </div>

        <div id="dice-section" class="content-section">
            <h2>麻將骰子</h2>
            <div class="dice-roller-container"><div id="dice-container" class="dice-container"><div class="dice">?</div><div class="dice">?</div><div class="dice">?</div></div><button id="roll-dice-btn">擲骰</button><div id="dice-result-area" class="result-area"><p>點擊「擲骰」按鈕來決定開門位置。</p><p style="color: #666; font-size: 0.9em;">(此規則以無花牌為準，若有花牌請自行+1敦)</p></div></div>
        </div>

        <div id="fortune-section" class="content-section">
            <h2>今日運勢 & 招財神</h2>
            <div class="fortune-card"><h3>今日運勢</h3><div class="fortune-item"><span class="fortune-label">幸運色：</span><span id="lucky-color" class="fortune-value"></span></div><div class="fortune-item"><span class="fortune-label">財運指數：</span><span id="wealth-index" class="fortune-value"></span></div><div class="fortune-item"><span class="fortune-label">恩公牌：</span><div id="benefactor-tiles" class="fortune-value hand-display small"></div></div></div>
            <div class="summon-altar">
                <div id="game-hall-container"><h3>招財遊戲廳</h3><div class="god-of-wealth">💰</div><div id="game-selection-menu"><p>選擇一款遊戲來贏取財神的庇佑吧！</p><div class="game-choices"><button class="game-choice-btn" data-game="slot-machine">財神拉霸機</button><button class="game-choice-btn" data-game="whack-a-tile">好運爆爆樂</button><button class="game-choice-btn" data-game="divination">誠心擲筊</button><button class="game-choice-btn" data-game="sequence">神之序列</button><button class="game-choice-btn" data-game="purification">寶牌淨化</button><button class="game-choice-btn" data-game="dragon-pearl">金龍吐珠</button><button class="game-choice-btn" data-game="memory-match">對對碰</button><button class="game-choice-btn" data-game="chosen-one">天選之人</button><button class="game-choice-btn" data-game="wind-rises">風生水起</button><button class="game-choice-btn" data-game="scoop-the-moon">海底撈月</button></div></div><div id="slot-machine-game" class="ritual-game-container"><button class="back-to-selection-btn">返回選擇</button><h4>財神拉霸機</h4><p>您有 5 次機會，拉中幸運組合！</p><div class="slot-machine"><div class="reels-container"><div class="reel" id="reel1"></div><div class="reel" id="reel2"></div><div class="reel" id="reel3"></div></div><div class="slot-overlay"></div></div><button id="spin-btn">拉霸</button><p>剩餘次數：<strong id="spins-left">5</strong></p><div id="slot-result" class="summon-result-area"></div></div><div id="whack-a-tile-game" class="ritual-game-container"><button class="back-to-selection-btn">返回選擇</button><h4>好運爆爆樂</h4><p>在15秒內累積88分，點擊幸運牌加分，小心倒楣牌會扣分！</p><div id="game-info-bar"><span>時間: <strong id="game-timer">15</strong> 秒</span><span>分數: <strong id="game-score">0</strong> / 88</span></div><div id="whack-a-tile-board" class="whack-a-tile-board"></div><button id="start-whack-game-btn">開始挑戰</button><div id="whack-result" class="summon-result-area"></div></div><div id="divination-game" class="ritual-game-container"><button class="back-to-selection-btn">返回選擇</button><h4>誠心擲筊</h4><p>誠心向財神爺祈求好運吧！</p><div id="divination-blocks" class="divination-blocks-container"><div class="block" id="block-1"></div><div class="block" id="block-2"></div></div><button id="cast-blocks-btn">誠心擲筊</button><div id="divination-result" class="summon-result-area"></div></div><div id="sequence-game" class="ritual-game-container"><button class="back-to-selection-btn">返回選擇</button><h4>神之序列</h4><p>找出正確的三張供品順序，您有3次機會。</p><div id="sequence-slots" class="offering-slots-container"><div class="offering-slot">?</div><div class="offering-slot">?</div><div class="offering-slot">?</div></div><p>剩餘嘗試次數：<strong id="sequence-attempts-left">3</strong></p><button id="submit-sequence-btn">獻上供品</button><button id="reset-sequence-btn">重置</button><div id="sequence-tile-selection" class="tile-selection-grid small-grid"></div><div id="sequence-result" class="summon-result-area"></div></div><div id="purification-game" class="ritual-game-container"><button class="back-to-selection-btn">返回選擇</button><h4>寶牌淨化</h4><p>快速點擊發光的寶牌以完成儀式！</p><div id="purification-tiles" class="purification-tiles-container"></div><div id="purification-progress-container"><div id="purification-progress-bar"></div></div><button id="start-ritual-btn">開始儀式</button><div id="purification-result" class="summon-result-area"></div></div><div id="dragon-pearl-game" class="ritual-game-container"><button class="back-to-selection-btn">返回選擇</button><h4>金龍吐珠</h4><p>抓準時機，讓龍珠擊中移動的「中」牌！</p><div id="dragon-pearl-board"><div id="dragon-pearl-dragon">中</div><div id="dragon-pearl-pearl">發</div></div><button id="launch-pearl-btn">發射龍珠</button><div id="dragon-pearl-result" class="summon-result-area"></div></div><div id="memory-match-game" class="ritual-game-container"><button class="back-to-selection-btn">返回選擇</button><h4>對對碰</h4><p>翻開所有配對的牌即可成功！</p><div id="memory-match-info"><span>剩餘步數: <strong id="memory-moves-left">30</strong></span></div><div id="memory-match-board"></div><div id="memory-match-result" class="summon-result-area"></div></div><div id="chosen-one-game" class="ritual-game-container"><button class="back-to-selection-btn">返回選擇</button><h4>天選之人</h4><p>記住「發」的位置，洗牌後把它找出來！</p><div id="chosen-one-board"></div><button id="start-chosen-one-btn">開始洗牌</button><div id="chosen-one-result" class="summon-result-area"></div></div><div id="wind-rises-game" class="ritual-game-container"><button class="back-to-selection-btn">返回選擇</button><h4>風生水起</h4><p>跟隨風牌亮起的順序，重複點擊！</p><div id="wind-rises-board"></div><button id="start-wind-rises-btn">開始挑戰</button><div id="wind-rises-result" class="summon-result-area"></div></div><div id="scoop-the-moon-game" class="ritual-game-container"><button class="back-to-selection-btn">返回選擇</button><h4>海底撈月</h4><p>按住並向上拖曳，小心地將最後一張牌「撈」起！</p><div id="scoop-the-moon-board"><div id="scoop-channel"><div id="scoop-tile">1條</div></div></div><div id="scoop-the-moon-result" class="summon-result-area"></div></div></div><div id="blessing-countdown-area" class="summon-result-area"></div></div>
        </div>
        
        <div id="finder-section" class="content-section">
            <h2>找牌咖</h2>
            <div id="lobby-view">
                <div class="lobby-actions"><button id="show-create-table-view-btn">我要開桌</button><div class="join-by-id"><input type="text" id="join-room-id-input" placeholder="輸入房號加入"><button id="join-by-id-btn">加入</button></div></div>
                <h3>牌咖大廳</h3><div id="table-list-container"><p>正在連接伺服器...</p></div>
            </div>
            <div id="create-table-view" style="display: none;">
                <button class="back-to-lobby-btn">返回大廳</button>
                <h3>開設新桌</h3>
                <form id="create-table-form" class="table-form">
                    <div class="form-group"><label for="city-select">縣市：</label><select id="city-select" required></select></div>
                    <div class="form-group"><label for="parlor-name-input">麻將館名稱：</label><input type="text" id="parlor-name-input" placeholder="例如：我家" required></div>
                    <div class="form-group"><label for="play-time-input">預計開打時間：</label><input type="time" id="play-time-input" required></div>
                    <div class="form-group"><label>大小：</label><div class="stakes-options"><label><input type="radio" name="stakes" value="30/10" checked> 30/10</label><label><input type="radio" name="stakes" value="50/20"> 50/20</label><label><input type="radio" name="stakes" value="100/20"> 100/20</label><label><input type="radio" name="stakes" value="100/50"> 100/50</label><label><input type="radio" name="stakes" value="任意"> 任意</label></div></div>
                    <button type="submit">確認開桌</button>
                </form>
            </div>
            <div id="room-details-view" style="display: none;">
                <button class="back-to-lobby-btn">返回大廳</button>
                <h3>房間詳情</h3><div id="room-info" class="room-info-box"></div>
            </div>
        </div>

    </main>

    <div id="modal" class="modal"><div class="modal-content"><span class="close-btn">&times;</span><div id="modal-body"></div></div></div>
    <div id="settings-modal" class="modal"><div class="modal-content"><span class="close-btn">&times;</span><h3>設定</h3><div id="settings-body" class="settings-menu"><div class="settings-item" id="taishu-table-btn"><span>台數表</span><span>&gt;</span></div><div class="settings-item" id="baopai-rules-btn"><span>包牌行為</span><span>&gt;</span></div><div class="settings-item"><span>自訂主題</span><input type="color" id="theme-color-picker"></div><div class="settings-item" id="privacy-policy-btn"><span>隱私權政策</span><span>&gt;</span></div></div></div></div>

    <script src="script.js"></script>
</body>
</html>